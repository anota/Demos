---
title: ES6：Promise
---
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
</body>
<script>
    "user strict"
    var p1 = new Promise(function(resolve, reject) {
        setTimeout(function() {
            resolve()
        }, 400);

    })

    // p1.then(function() {
    //     console.log("成功");
    //     console.log(b);
    // }, function() {
    //     console.log("失败");
    // }).catch(function(e) {
    //     console.log(e);
    // })

    /*
        什么是promise
        ES6中Promise对象是一个构造函数，用来生成Promise实例。下面是Promise对象的基本用法。
        所谓Promise对象，就是代表了未来某个将要发生的时间（通常是一个异步操作）。它的好处在于，有了Promise对象，就可以将异步操作以同步流程表达出来，避免了层层嵌套的回调函数
        Promise
            new Promise(function(resolve,reject){})
            返回Pormise实例对象
        then
            promise.then(resolve,reject);
            返回promise
    */

    /*
        Promise.all方法用于将多个Promis实例，包装成一个新的Promise实例。
        参数要求拥有Iterator接口，并且每一项都是promise实例
        var p = Promise.all([p1,p2,p3]);
        p的状态由p1、p2、p3决定，分成两种情况
        （1）只有p1、p2、p3的状态都变成fulfilled，p的状态才会变成fulfilled，此时p1、p2、p3的返回值组成一个数组，传递给p的回调函数。
        （2）只要p1、p2、p3之中有一个被rejected，p的状态就会变成rejected，此时第一个被reject的实例的返回值，会传递给p的回调函数。

        Promise.race
        与Promise.all方法类似将多个promise包装成一个新的promise实例
        但是其中有一项的状态发生改变新的实例的状态也会随之改变。

        var p = Pormise.race([p1,p2,p3])
        （1）只要p1、p2、p3中一个的状态变成了fulfilled，p的状态就会变成fulfilled
        （2）只要p1、p2、p3中有一个状态被rejected、p的状态就会变成rejected，此时第一个被reject的实例的返回值，会传递给p的回调函数。
    */

    var p1 = new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve();
            console.log("p1");
        }, 200);
    });

    var p2 = new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve();
            console.log("p2");
        }, 300);
    })

    var p3 = new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve();
            console.log("p3");
        }, 400);
    })

    var p = Promise.all([p1, p2, p3]);
    p.then(() => console.log("successed"), () => console.log("failed"));
</script>

</html>